{
  "firestore": {
    "rules": "rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /users/{uid} {\n      allow create: if request.auth.uid == uid;\n      allow read, update, delete: if request.auth.uid == uid || get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    function isUserInCompany(companyId) {\n      return exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&\n        (get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin' ||\n         get(/databases/$(database)/documents/users/$(request.auth.uid)).data.companyId == companyId);\n    }\n    match /companies/{companyId} {\n      allow read: if isUserInCompany(companyId);\n      allow write: if isUserInCompany(request.resource.data.companyId);\n    }\n    match /bankbooks/{docId} {\n      allow read: if isUserInCompany(resource.data.companyId);\n      allow create, update: if isUserInCompany(request.resource.data.companyId);\n      allow delete: if isUserInCompany(resource.data.companyId);\n    }\n    match /cashbooks/{docId} {\n      allow read: if isUserInCompany(resource.data.companyId);\n      allow create, update: if isUserInCompany(request.resource.data.companyId);\n      allow delete: if isUserInCompany(resource.data.companyId);\n    }\n    match /payables/{docId} {\n      allow read: if isUserInCompany(resource.data.companyId);\n      allow create, update: if isUserInCompany(request.resource.data.companyId);\n      allow delete: if isUserInCompany(resource.data.companyId);\n    }\n    match /receivables/{docId} {\n      allow read: if isUserInCompany(resource.data.companyId);\n      allow create, update: if isUserInCompany(request.resource.data.companyId);\n      allow delete: if isUserInCompany(resource.data.companyId);\n    }\n    match /banks/{docId} {\n      allow read: if isUserInCompany(resource.data.companyId);\n      allow create, update: if isUserInCompany(request.resource.data.companyId);\n      allow delete: if isUserInCompany(resource.data.companyId);\n    }\n    match /parties/{docId} {\n      allow read: if isUserInCompany(resource.data.companyId);\n      allow create, update: if isUserInCompany(request.resource.data.companyId);\n      allow delete: if isUserInCompany(resource.data.companyId);\n    }\n    match /expenses/{docId} {\n      allow read: if isUserInCompany(resource.data.companyId);\n      allow create, update: if isUserInCompany(request.resource.data.companyId);\n      allow delete: if isUserInCompany(resource.data.companyId);\n    }\n    match /income/{docId} {\n      allow read: if isUserInCompany(resource.data.companyId);\n      allow create, update: if isUserInCompany(request.resource.data.companyId);\n      allow delete: if isUserInCompany(resource.data.companyId);\n    }\n  }\n}\n"
  }
}